local a=module('_core','libs/Tunnel')local b=module('_core','libs/Proxy')local c=a.getInterface("hpp_tattoos")API=b.getInterface('API')cAPI=a.getInterface('cAPI')local d=module("hpp_tattoos","config/cfg")Citizen.CreateThread(function()while true do Citizen.Wait(5*60*1000)collectgarbage("count")collectgarbage("collect")end end)local e=0;RegisterCommand("tattoo",function(f,g,h)local i=c.getPlayerTattoos()print(#i)for j,k in pairs(i)do local l=json.decode(k)drawTattoo(l[1],l[2])end end)local m=true;Citizen.CreateThread(function()while m do Citizen.Wait(1000)local n=c.getPlayerTattoos()if not n then else Citizen.Wait(5000)for j,k in pairs(n)do local l=json.decode(k)print("array[1]",l[1])print("array[2]",l[2])drawTattoo(l[1],l[2])end;if m then TriggerServerEvent("hoppe:build:prison:time")TriggerEvent("hoppe:update:eye:colors")TriggerEvent("hoppe:hud:update")TriggerEvent("hoppe:build:chests")TriggerServerEvent("gcPhone:allUpdate")end;m=false;e=0 end end end)local o={}function drawTattoo(p,q)e=e+1;ApplyPedOverlay(GetPlayerPed(-1),GetHashKey(p),GetHashKey(d.tattoosList[p][q].nameHash))table.insert(o,1,{nameHash=d.tattoosList[p][q].nameHash,_collection=p,_index=q})end;function clearTatttos()ClearPedDecorations(GetPlayerPed(-1))end;function ToogleTattooMenu(r)SetNuiFocus(r,r)SendNUIMessage({open=r,tattolist=d.tattoosList})end;RegisterNUICallback("applytattoo",function(s)drawTattoo(s._collection,tonumber(s._index))end)Citizen.CreateThread(function()SetNuiFocus(false,false)end)RegisterNUICallback("rotateperson",function(s)local t=GetPlayerPed(-1)local u=GetEntityHeading(t)SetEntityHeading(t,u+20)end)RegisterNUICallback("closeMenu",function()ToogleTattooMenu(false)if c.tryPayTattoos()>e*500 then local v=e*500;TriggerEvent("Notify","sucesso","Você pagou "..v.." pelas tatuagens!")for j,k in pairs(o)do if j then c.saveTattoo(k.nameHash,k._collection,k._index)end end;o={}e=0 else o={}e=0;clearTatttos()local i=c.getPlayerTattoos()for j,k in pairs(i)do local l=json.decode(k)drawTattoo(l[1],l[2])end;TriggerEvent("Notify","negado","Você não tem dinheiro!")end end)RegisterNUICallback("closeMenu2",function()ToogleTattooMenu(false)clearTatttos()local i=c.getPlayerTattoos()for j,k in pairs(i)do local l=json.decode(k)drawTattoo(l[1],l[2])end end)RegisterNUICallback("cleantattoos",function()clearTatttos()c.clearTattoosInDb()end)local w=3000;Citizen.CreateThread(function()while true do for j,k in pairs(d.tattoosShops)do local t=GetPlayerPed(-1)local x,y,z=table.unpack(GetEntityCoords(t))local A,B,C=k.x,k.y,k.z;local D=GetDistanceBetweenCoords(x,y,z,A,B,C,true)if D<20 then w=1;DrawMarker(20,A,B,C,0,0,0,0,0,0,1.0,1.0,1.0,0,150,150,50,1,1,1,1)if D<1.5 then if IsControlJustPressed(0,38)then ToogleTattooMenu(true)end end end end;Citizen.Wait(w)end end)Citizen.CreateThread(function()for j,k in pairs(d.tattoosShops)do local E=AddBlipForCoord(k.x,k.y,k.z)SetBlipSprite(E,75)SetBlipAsShortRange(E,true)SetBlipColour(E,4)SetBlipScale(E,0.4)BeginTextCommandSetBlipName("STRING")AddTextComponentString("Loja | Tatuagens")EndTextCommandSetBlipName(E)end end)