local a=module('_core','libs/Tunnel')local b=module('_core','libs/Proxy')local c=a.getInterface("hpp_barbershop")API=b.getInterface('API')cAPI=a.getInterface('cAPI')Citizen.CreateThread(function()while true do Citizen.Wait(5*60*1000)collectgarbage("count")collectgarbage("collect")end end)local d=module("hpp_barbershop","config/spots")local e=false;RegisterNetEvent("hoppe:update:eye:colors")AddEventHandler("hoppe:update:eye:colors",function()local f=c.getEyeColor()if f then print("eye updated"..f)local g=PlayerPedId()SetPedEyeColor(g,parseInt(f))end end)function ToogleBarberShopMenu(h)local i=GetPlayerPed(-1)local j=GetEntityModel(i)local k=getCustomization()local l=GetPedHeadOverlayData(i,1)local m=GetPedHeadOverlayData(i,5)local n=GetPedHeadOverlayData(i,8)local o=GetPedEyeColor(i)SetNuiFocus(h,h)if h then SendNUIMessage({open=h,firstOpen=e,custom=k,modelhash=j,facialHair=l,blush=m,lipstick=n,eyecolor=o})if not e then e=not e end else SendNUIMessage({open=h})local g=PlayerPedId()local p={}p[1]=GetPedHairColor(g)p[2]=GetPedHairHighlightColor(g)c.finishCustom(p,GetPedEyeColor(g))end end;RegisterNUICallback("setPedEyeColor",function(q)local i=PlayerPedId()SetPedEyeColor(i,tonumber(q.new_val))end)Citizen.CreateThread(function()SetNuiFocus(false,false)end)RegisterNUICallback("setPedEyeBrow",function(q)local i=PlayerPedId()SetPedHeadOverlay(i,2,tonumber(q.new_val),1.0)end)RegisterNUICallback("setPedEyeBrowColor",function(q)print(q.new_val)local i=PlayerPedId()SetPedHeadOverlayColor(i,2,1,parseInt(q.new_val),1)end)RegisterNUICallback("changeFacialHair",function(r)local i=GetPlayerPed(-1)SetPedHeadOverlay(i,1,r,0.99)end)RegisterNUICallback("changeFacialHairColor",function(s)local i=GetPlayerPed(-1)SetPedHeadOverlayColor(i,1,1,s,s)end)RegisterNUICallback("changeBlushIndex",function(t)local i=GetPlayerPed(-1)SetPedHeadOverlay(i,5,t,0.99)end)RegisterNUICallback("changeLipStickIndex",function(t)local i=GetPlayerPed(-1)SetPedHeadOverlay(i,8,t,0.99)end)RegisterNUICallback("changeHairModel",function(r)local i=GetPlayerPed(-1)SetPedComponentVariation(i,2,r,0,0)SetPedHairColor(i,GetPedHairColor(i),0)end)RegisterNUICallback("changeHairColor",function(s)local i=GetPlayerPed(-1)SetPedHairColor(i,s,0)end)RegisterNUICallback("closeMenu",function()ToogleBarberShopMenu(false)end)local u=3000;local v=false;Citizen.CreateThread(function()while true do Citizen.Wait(u)for w=1,#d.spots do if w==1 then v=false end;local i=GetPlayerPed(-1)local x,y,z=table.unpack(GetEntityCoords(i))local A,B=GetGroundZFor_3dCoord(d.spots[w][1],d.spots[w][2],d.spots[w][3])local C=GetDistanceBetweenCoords(d.spots[w][1],d.spots[w][2],B,x,y,z,true)if C<10 then v=true;DrawMarker(20,d.spots[w][1],d.spots[w][2],d.spots[w][3],0,0,0,0,0,0,0.4,0.4,0.4,0,150,150,50,1,1,1,1)DrawText3D(d.spots[w][1],d.spots[w][2],d.spots[w][3]+0.3,"SALÃƒO DE BELEZA",1.0,4,100)if C<1.5 then if IsControlJustPressed(0,38)then ToogleBarberShopMenu(true)end end end end;if v then u=1 else u=3000 end end end)Citizen.CreateThread(function()for w=1,#d.spots do local D=AddBlipForCoord(d.spots[w][1],d.spots[w][2],d.spots[w][3])SetBlipSprite(D,71)SetBlipAsShortRange(D,true)SetBlipColour(D,4)SetBlipScale(D,0.7)BeginTextCommandSetBlipName("STRING")AddTextComponentString("Barbearia")EndTextCommandSetBlipName(D)end end)function getCustomization()local i=GetPlayerPed(-1)local E={}E.modelhash=GetEntityModel(i)for w=0,20 do E[w]={GetPedDrawableVariation(i,w),GetPedTextureVariation(i,w),GetPedPaletteVariation(i,w)}end;for w=0,10 do E["p"..w]={GetPedPropIndex(i,w),math.max(GetPedPropTextureIndex(i,w),0)}end;return E end;function DrawText3D(x,y,z,F,G,H,I)local J,K,L=World3dToScreen2d(x,y,z)local M,N,O=table.unpack(GetGameplayCamCoords())local P=GetDistanceBetweenCoords(M,N,O,x,y,z,1)local Q=1/P*G;local R=1/GetGameplayCamFov()*100;local Q=Q*R;if J then SetTextScale(0.0*Q,1.1*Q)SetTextFont(H)SetTextProportional(1)SetTextColour(255,255,255,I)SetTextDropshadow(0,0,0,0,255)SetTextEdge(2,0,0,0,150)SetTextDropShadow()SetTextOutline()SetTextEntry("STRING")SetTextCentre(1)AddTextComponentString(F)DrawText(K,L)end end