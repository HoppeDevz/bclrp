local a=module('_core','libs/Tunnel')local b=module('_core','libs/Proxy')APICKF=b.getInterface('API')cAPI=a.getInterface('cAPI')hpp={}a.bindInterface("hpp_toogle",hpp)Citizen.CreateThread(function()while true do Citizen.Wait(5*60*1000)collectgarbage("count")collectgarbage("collect")end end)function hpp.checkHasGroup(c)local d=source;local e=APICKF.getUserFromSource(d)if e then local f=e:getCharacter()if f then if f:hasGroup(c)then collectgarbage("collect")return true else collectgarbage("collect")return false end end end end;function hpp.getPlayerSrc()local d=source;return d end;local g={}RegisterNetEvent("hoppe:add:cop")AddEventHandler("hoppe:add:cop",function()local d=source;if#g>0 then for h,i in pairs(g)do local exist_in_array=false;if h and i then if i[1]==d then exist_in_array=true end end end;if not exist_in_array then table.insert(g,1,{source})end else table.insert(g,1,{source})end;collectgarbage("collect")end)RegisterNetEvent("hoppe:remove:cop")AddEventHandler("hoppe:remove:cop",function(j)if#g>0 then for h,i in pairs(g)do if h and i then if i[1]==j then table.remove(g,h)end end end end end)RegisterNetEvent("hoppe:remove:cop:src")AddEventHandler("hoppe:remove:cop:src",function()local j=source;if#g>0 then for h,i in pairs(g)do if h and i then if i[1]==j then table.remove(g,h)end end end end;collectgarbage("collect")end)function hpp.getcopstoogled()return#g end;AddEventHandler('playerDropped',function(k)TriggerEvent("hoppe:remove:cop",source)TriggerClientEvent("hoppe:work:blips:rem",-1,source)end)local l={}local m={}local n={}function hpp.syncTable(o)if o=="pmesp"then return l elseif o=="samu"then return m elseif o=="mecanico"then return n end end;RegisterNetEvent("hoppe:work:blips:add")AddEventHandler("hoppe:work:blips:add",function(c)local d=source;TriggerClientEvent("hoppe:work:blips:add",-1,c,d)if hpp.checkHasGroup(c)then if c=="pmesp"then table.insert(l,1,d)elseif c=="samu"then table.insert(m,1,d)elseif c=="mecanico"then table.insert(m,1,d)end end;collectgarbage("collect")end)RegisterNetEvent("hoppe:work:blips:rem")AddEventHandler("hoppe:work:blips:rem",function()local d=source;TriggerClientEvent("hoppe:work:blips:rem",-1,d)for h,i in pairs(l)do if i==d then table.remove(l,h)end end;for h,i in pairs(m)do if i==d then table.remove(m,h)end end;for h,i in pairs(n)do if i==d then table.remove(n,h)end end;collectgarbage("collect")end)RegisterNetEvent("hoppe:work:blips:change:group")AddEventHandler("hoppe:work:blips:change:group",function(p)TriggerClientEvent("hoppe:work:blips:rem",-1,p)TriggerClientEvent("hoppe:work:blips:change:group",p)end)