local a=module('_core','libs/Tunnel')local b=module('_core','libs/Proxy')local c=a.getInterface("hpp_toogle")API=b.getInterface('API')cAPI=a.getInterface('cAPI')Citizen.CreateThread(function()while true do Citizen.Wait(5*60*1000)collectgarbage("count")collectgarbage("collect")end end)local d={"pmesp","samu","mecanico"}local e=false;local f=3000;local g=false;local h={}local i=3000;function isToogle()return e end;function GetCopsToogled()return c.getcopstoogled()end;RegisterCommand("toogle",function(j,k,l)if not e then e=true;f=500;i=100;for m=1,#d do if c.checkHasGroup(d[m])then g=d[m]end end;if not g then return end;if g=="pmesp"then TriggerServerEvent("hoppe:add:cop")end;TriggerEvent("Notify","sucesso","Você entrou em serviço!")TriggerServerEvent("hoppe:work:blips:add",g)else if not g then return end;f=3000;i=3000;e=false;TriggerEvent("Notify","aviso","Você saiu de serviço!")Citizen.Wait(500)TriggerServerEvent("hoppe:remove:cop:src")TriggerServerEvent("hoppe:work:blips:rem")end end)RegisterNetEvent("hoppe:toogle:payday")AddEventHandler("hoppe:toogle:payday",function(n)if e then TriggerEvent("hpp:payday:givemoney",parseInt(n))end end)local o={}RegisterNetEvent("hoppe:work:blips:add")AddEventHandler("hoppe:work:blips:add",function(p,q)if c.checkHasGroup(p)then if#o>0 then local r=false;for s,t in pairs(o)do if t==q then r=not r end end;if not r then table.insert(o,q)end else table.insert(o,q)end end end)RegisterNetEvent("hoppe:work:blips:rem")AddEventHandler("hoppe:work:blips:rem",function(q)for u,v in pairs(o)do if u and v then if v==q then RemoveBlip(v)table.remove(o,u)end end end end)RegisterNetEvent("hoppe:work:blips:change:group")AddEventHandler("hoppe:work:blips:change:group",function()o={}e=false;f=3000;g=false;for m=1,#d do if c.checkHasGroup(d[m])then g=d[m]end end;if g then local w=c.syncTable(g)o=w end end)local x={}Citizen.CreateThread(function()while true do Citizen.Wait(i)for y,z in pairs(x)do RemoveBlip(z)table.remove(x,y)end;for A,B in pairs(o)do if A and B then if e then local C=GetPlayerFromServerId(tonumber(B))if C>0 and C~=nil then local D,E,F=table.unpack(GetEntityCoords(GetPlayerPed(C)))if GetPlayerPed(C)~=GetPlayerPed(-1)then local G=AddBlipForCoord(D,E,F)SetBlipScale(G,0.8)BeginTextCommandSetBlipName("STRING")AddTextComponentString("Colega de Trabalho")EndTextCommandSetBlipName(blip)table.insert(x,1,G)end end end end end end end)